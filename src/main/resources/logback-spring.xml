<?xml version="1.0" encoding="UTF-8"?>
<configuration>

    <!-- Define a property for the base path of your log files -->
    <property name="LOG_PATH" value="logs/user" />

    <!-- ============================================================== -->
    <!-- Appenders: These define WHERE log messages are written to.     -->
    <!-- ============================================================== -->

    <!-- Appender 1: CONSOLE -->
    <!-- Writes logs to the standard console. This is what you see when you run `docker logs`. -->
    <appender name="CONSOLE" class="ch.qos.logback.core.ConsoleAppender">
        <encoder>
            <!-- Defines the format of the log message -->
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <!-- Appender 2: ROLLING_FILE_APP (For general application logs) -->
    <!-- Writes logs to a file that rotates daily. -->
    <appender name="ROLLING_FILE_APP" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <file>${LOG_PATH}/application.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <!-- Daily rollover -->
            <fileNamePattern>${LOG_PATH}/application-%d{yyyy-MM-dd}.log</fileNamePattern>
            <!-- Keep 30 days' worth of history -->
            <maxHistory>30</maxHistory>
        </rollingPolicy>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <!-- Appender 3: ROLLING_FILE_ACONTROLLER (For AController specific logs) -->
    <!-- This is a dedicated appender just for your controller's logs. -->
    <appender name="ROLLING_FILE_USER" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <!-- It writes to a separate subdirectory -->
        <file>${LOG_PATH}/user.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOG_PATH}/user-%d{yyyy-MM-dd}.log</fileNamePattern>
            <maxHistory>30</maxHistory>
        </rollingPolicy>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>

    <appender name="ROLLING_FILE_BUSINESS" class="ch.qos.logback.core.rolling.RollingFileAppender">
        <!-- It writes to a separate subdirectory -->
        <file>${LOG_PATH}/business.log</file>
        <rollingPolicy class="ch.qos.logback.core.rolling.TimeBasedRollingPolicy">
            <fileNamePattern>${LOG_PATH}/business-%d{yyyy-MM-dd}.log</fileNamePattern>
            <maxHistory>30</maxHistory>
        </rollingPolicy>
        <encoder>
            <pattern>%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
        </encoder>
    </appender>


    <!-- ============================================================== -->
    <!-- Loggers: These control WHICH messages go to WHICH appenders.   -->
    <!-- ============================================================== -->

    <!-- The ROOT logger. This is the default for the entire application. -->
    <!-- It will log messages of level INFO or higher to the CONSOLE and the general ROLLING_FILE_APP. -->
    <root level="INFO">
        <appender-ref ref="CONSOLE" />
        <appender-ref ref="ROLLING_FILE_APP" />
    </root>

    <!-- A custom, named logger for our AController. -->
    <!-- We give it a specific name, "AControllerLogger". -->
    <logger name="userLogger" level="DEBUG" additivity="false">
        <!-- It will log messages of level DEBUG or higher ONLY to its dedicated file. -->
        <appender-ref ref="ROLLING_FILE_USER" />
        <!-- We also add console logging for convenience during development. -->
        <appender-ref ref="CONSOLE" />
    </logger>

    <logger name="businessLogger" level="DEBUG" additivity="false">
        <!-- It will log messages of level DEBUG or higher ONLY to its dedicated file. -->
        <appender-ref ref="ROLLING_FILE_BUSINESS" />
        <!-- We also add console logging for convenience during development. -->
        <appender-ref ref="CONSOLE" />
    </logger>

</configuration>
